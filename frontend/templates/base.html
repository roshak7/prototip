<!DOCTYPE html>
<html lang="ru" class="{% if request.COOKIES.theme == 'dark' %}dark-theme{% endif %}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}–ò–° –î–†{% endblock %}</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Custom CSS -->
    <link href="/static/css/main.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect width='32' height='32' rx='6' fill='%23007bff'/%3E%3Ctext x='16' y='22' font-size='16' text-anchor='middle' fill='white' font-family='Arial, sans-serif'%3E–ò–°%3C/text%3E%3C/svg%3E">
    {% block extra_css %}{% endblock %}
</head>
<body>
    <!-- –®–∞–ø–∫–∞ -->
    <header class="header">
        <a href="{% url 'dashboard' %}" class="header-logo">–ò–° –î–†</a>
        
        <div class="d-flex align-items-center">
            <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã -->
            <div class="d-flex align-items-center me-3">
                <span class="toggle-label">–°–≤–µ—Ç–ª–∞—è</span>
                <label class="theme-toggle">
                    <input type="checkbox" id="themeToggle" {% if request.COOKIES.theme == 'dark' %}checked{% endif %}>
                    <span class="toggle-slider"></span>
                </label>
                <span class="toggle-label">–¢—ë–º–Ω–∞—è</span>
            </div>
            
            {% if user.is_authenticated %}
            <!-- –í—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ "–°–º–µ–Ω–∏—Ç—å —Ä–æ–ª—å" -->
            <div class="dropdown">
                <button class="dropdown-button">
                    {% if user.groups.all.0.name %}
                        {{ user.groups.all.0.name }}
                    {% else %}
                        –†–æ–ª—å
                    {% endif %}
                </button>
                <div class="dropdown-content">
                    <a href="#">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</a>
                    <a href="#">–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å</a>
                    <a href="#">–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç</a>
                </div>
            </div>
            
            <!-- –ö–Ω–æ–ø–∫–∞ "–≠–∫—Å–ø–æ—Ä—Ç" -->
            <div class="dropdown ms-3">
                <button class="dropdown-button">
                    –≠–∫—Å–ø–æ—Ä—Ç üì•
                </button>
                <div class="dropdown-content">
                    <a href="#" onclick="showToast('–≠–∫—Å–ø–æ—Ä—Ç –≤ Excel –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω', 'warning')">Excel</a>
                    <a href="#" onclick="showToast('–≠–∫—Å–ø–æ—Ä—Ç –≤ PDF –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω', 'warning')">PDF</a>
                </div>
            </div>
            
            <!-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å -->
            <div class="dropdown ms-3">
                <button class="dropdown-button">
                    {{ user.username }}
                </button>
                <div class="dropdown-content">
                    <a href="{% url 'profile' %}">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a>
                    <a href="{% url 'logout' %}">–í—ã—Ö–æ–¥</a>
                </div>
            </div>
            {% endif %}
        </div>
    </header>

    <div class="layout-container">
        <!-- –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é -->
        {% if user.is_authenticated %}
        <aside class="sidebar">
            <nav>
                <ul class="sidebar-nav">
                    <li>
                        <a href="{% url 'dashboard' %}" class="{% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}">
                            –î–∞—à–±–æ—Ä–¥
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'reports' %}" class="{% if request.resolver_match.url_name == 'reports' %}active{% endif %}">
                            –û—Ç—á–µ—Ç—ã
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'inventory' %}" class="{% if request.resolver_match.url_name == 'inventory' %}active{% endif %}">
                            –°–∫–ª–∞–¥
                        </a>
                    </li>
                    {% if user.groups.all.0.name == '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä' %}
                    <li>
                        <a href="{% url 'settings' %}" class="{% if request.resolver_match.url_name == 'settings' %}active{% endif %}">
                            –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                        </a>
                    </li>
                    {% endif %}
                    <li>
                        <a href="{% url 'alerts' %}" class="{% if request.resolver_match.url_name == 'alerts' %}active{% endif %}">
                            –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                        </a>
                    </li>
                </ul>
            </nav>
        </aside>
        {% endif %}

        <!-- –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å -->
        <main class="main-content">
            {% block content %}
            {% endblock %}
        </main>
    </div>

    <!-- Custom JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/js/main.js"></script>
    {% block extra_js %}{% endblock %}
</body>
</html>
